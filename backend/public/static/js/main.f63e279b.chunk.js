(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,a){e.exports=a(34)},29:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),c=a(20),s=a.n(c),r=(a(29),a(23)),i=a(6),o=a(4),d=a(2),u=a(10),h=a(9),m=a(3),v=a(11),f=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(o.a)(this,e),this.controller=new AbortController,a.signal=this.controller.signal,this.request=fetch(t,a)}return Object(d.a)(e,null,[{key:"post",value:function(t,a){return new e(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}},{key:"get",value:function(t,a){return new e(t,a)}}]),Object(d.a)(e,[{key:"whenDataArrives",value:function(e){return this.request.then(function(e){return e.json()}).then(function(t){e(t)}).catch(function(e){console.log(e)}),this}},{key:"abort",value:function(){this.controller.abort()}}]),e}(),p=function(){function e(){Object(o.a)(this,e)}return Object(d.a)(e,null,[{key:"getCurrentProducts",value:function(){var e=localStorage.getItem("shoppingCartProducts");return JSON.parse(e)}},{key:"setCurrentProducts",value:function(e){var t=JSON.stringify(e);localStorage.setItem("shoppingCartProducts",t)}},{key:"clear",value:function(){this.setCurrentProducts([])}},{key:"createProductsOrder",value:function(e){return f.post("/apiv1/shopping-cart/create-order",e)}}]),e}(),b=function(){function e(){Object(o.a)(this,e)}return Object(d.a)(e,null,[{key:"getAll",value:function(){return f.get("/apiv1/products")}}]),e}(),g=function(){function e(){Object(o.a)(this,e)}return Object(d.a)(e,null,[{key:"getAll",value:function(){return f.get("/apiv1/units")}}]),e}(),P=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).handleAddProduct=a.handleAddProduct.bind(Object(m.a)(a)),a.handleSelectedProductChanged=a.handleSelectedProductChanged.bind(Object(m.a)(a)),a.handleselectedUnitChanged=a.handleselectedUnitChanged.bind(Object(m.a)(a)),a.handleSelectedAmountChanged=a.handleSelectedAmountChanged.bind(Object(m.a)(a)),a.unselectedUnit={id:0,name:""},a.unselectedProduct={id:0,name:"",units:[]},a.state={selectedProduct:a.unselectedProduct,selectedAmount:0,selectedUnit:a.unselectedUnit,allProducts:[],allUnits:[]},a}return Object(v.a)(t,e),Object(d.a)(t,[{key:"initializeDropDowns",value:function(){var e=window.M,t=document.querySelectorAll("select");e.FormSelect.init(t)}},{key:"updateProducts",value:function(e){this.setState({allProducts:e})}},{key:"updateUnits",value:function(e){this.setState({allUnits:e})}},{key:"componentDidMount",value:function(){var e=this;this.initializeDropDowns(),this.productsQuery=b.getAll().whenDataArrives(function(t){e.updateProducts(t.products)}),this.unitsQuery=g.getAll().whenDataArrives(function(t){e.updateUnits(t.units)})}},{key:"componentDidUpdate",value:function(){this.initializeDropDowns()}},{key:"componentWillUnmount",value:function(){this.productsQuery.abort()}},{key:"handleAddProduct",value:function(e){e.preventDefault();var t={product:this.state.selectedProduct,amount:this.state.selectedAmount,unit:this.state.selectedUnit};this.props.addProduct(t)}},{key:"handleSelectedProductChanged",value:function(e){var t=parseInt(e.target.value),a=this.state.allProducts.find(function(e){return e.id===t});void 0===a&&(a=this.unselectedProduct),this.setState({selectedProduct:a,selectedUnit:this.unselectedUnit})}},{key:"handleSelectedAmountChanged",value:function(e){var t=parseInt(e.target.value);this.setState({selectedAmount:t})}},{key:"handleselectedUnitChanged",value:function(e){var t=parseInt(e.target.value),a=this.state.allUnits.find(function(e){return e.id===t});void 0===a&&(a=this.unselectedUnit),this.setState({selectedUnit:a})}},{key:"isValidProductRequest",value:function(){return 0!==this.state.selectedProduct.id&&0!==this.state.selectedUnit.id&&this.state.selectedAmount>0}},{key:"render",value:function(){var e=this.state.selectedProduct,t=this.state.selectedUnit,a=this.isValidProductRequest()?"":" disabled";return l.a.createElement("form",{onSubmit:this.handleAddProduct},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"input-field col s6"},l.a.createElement("select",{value:e.id,onChange:this.handleSelectedProductChanged},this.renderAvailableProducts()),l.a.createElement("label",null,"Producto")),l.a.createElement("div",{className:"input-field col s2"},l.a.createElement("input",{value:this.state.selectedAmount,type:"number",className:"validate",onChange:this.handleSelectedAmountChanged}),l.a.createElement("label",{className:"active"},"Cantidad")),l.a.createElement("div",{className:"input-field col s3"},l.a.createElement("select",{value:t.id,onChange:this.handleselectedUnitChanged},this.renderAvailableUnits()),l.a.createElement("label",null,"Unidad"))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s12 right-align"},l.a.createElement("button",{className:"btn waves-effect waves-light"+a,type:"submit"},"Agregar al pedido"))))}},{key:"renderAvailableProducts",value:function(){return[this.unselectedProduct].concat(this.state.allProducts).map(function(e){var t=0===e.id;return l.a.createElement("option",{key:e.id,value:e.id,disabled:t},e.name)})}},{key:"renderAvailableUnits",value:function(){return[this.unselectedUnit].concat(this.state.selectedProduct.units).map(function(e){var t=0===e.id;return l.a.createElement("option",{key:e.id,value:e.id,disabled:t},e.name)})}}]),t}(l.a.Component),E=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return l.a.createElement("table",null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Producto"),l.a.createElement("th",null,"Cantidad"),l.a.createElement("th",null))),l.a.createElement("tbody",null,this.renderProducts()))}},{key:"renderProducts",value:function(){var e=this;return this.props.selectedProducts.map(function(t,a){var n=void 0===e.props.onRemoveClicked?"":l.a.createElement("a",{className:"btn-small waves-effect waves-light red",onClick:function(){return e.props.onRemoveClicked({index:a})}},l.a.createElement("i",{className:"material-icons center"},"remove_circle"));return l.a.createElement("tr",{key:a},l.a.createElement("td",null,t.product.name),l.a.createElement("td",null,t.amount," ",t.unit.name),l.a.createElement("td",null,n))})}}]),t}(l.a.Component),N=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).addProduct=a.addProduct.bind(Object(m.a)(a)),a.goToCheckout=a.goToCheckout.bind(Object(m.a)(a)),a.handleRemoveProduct=a.handleRemoveProduct.bind(Object(m.a)(a));var n=p.getCurrentProducts();return a.state={selectedProducts:null===n?[]:n,checkout:!1},a}return Object(v.a)(t,e),Object(d.a)(t,[{key:"updateShoppingCart",value:function(e){this.setState({selectedProducts:e.products})}},{key:"addProduct",value:function(e){var t=this.state.selectedProducts.concat([e]);p.setCurrentProducts(t),this.setState({selectedProducts:t})}},{key:"goToCheckout",value:function(){this.setState({checkout:!0})}},{key:"handleRemoveProduct",value:function(e){var t=e.index,a=this.state.selectedProducts.filter(function(e,a){return a!==t});console.log(this.state.selectedProducts),console.log(t),console.log(a),p.setCurrentProducts(a),this.setState({selectedProducts:a})}},{key:"render",value:function(){if(!0===this.state.checkout)return l.a.createElement(i.a,{to:"/checkout"});var e=this.state.selectedProducts.length>0?"":" disabled";return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s12"},l.a.createElement("h5",{className:"center-align"},"Hac\xe9 tu pedido."))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"offset-s2 col s8"},l.a.createElement(P,{addProduct:this.addProduct}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"offset-s2 col s8"},l.a.createElement(E,{selectedProducts:this.state.selectedProducts,onRemoveClicked:this.handleRemoveProduct}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s12 right-align"},l.a.createElement("button",{className:"btn waves-effect waves-light"+e,onClick:this.goToCheckout},"Hacer el pedido"))))}}]),t}(l.a.Component),C=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this,e))).selectedProducts=p.getCurrentProducts(),a.handlePhoneNumberChanged=a.handlePhoneNumberChanged.bind(Object(m.a)(a)),a.handleNameChanged=a.handleNameChanged.bind(Object(m.a)(a)),a.handleLastNameChanged=a.handleLastNameChanged.bind(Object(m.a)(a)),a.sendProductsOrder=a.sendProductsOrder.bind(Object(m.a)(a)),a.handleOrderConfirmation=a.handleOrderConfirmation.bind(Object(m.a)(a)),a.state={name:"",lastName:"",phoneNumber:"",goToShoppingCart:!1},a}return Object(v.a)(t,e),Object(d.a)(t,[{key:"handleNameChanged",value:function(e){var t=e.target.value.trim();this.setState({name:t})}},{key:"handleLastNameChanged",value:function(e){var t=e.target.value.trim();this.setState({lastName:t})}},{key:"handlePhoneNumberChanged",value:function(e){var t=e.target.value.trim();this.setState({phoneNumber:t})}},{key:"sendProductsOrder",value:function(){this.query=p.createProductsOrder({name:this.state.name,lastName:this.state.lastName,phoneNumber:this.state.phoneNumber,selectedProducts:this.selectedProducts}).whenDataArrives(this.handleOrderConfirmation)}},{key:"handleOrderConfirmation",value:function(e){this.query=void 0,p.clear(),this.setState({goToShoppingCart:!0})}},{key:"componentWillUnmount",value:function(){void 0!==this.query&&(this.query.abort(),this.query=void 0)}},{key:"isValidForm",value:function(){return this.state.name.length>0&&this.state.lastName.length>0&&this.state.phoneNumber.length>0}},{key:"render",value:function(){if(!0===this.state.goToShoppingCart)return l.a.createElement(i.a,{to:"/"});var e=this.isValidForm()?"":" disabled";return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s12"},l.a.createElement("h5",{className:"center-align"},"Confirm\xe1 tu pedido."))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"offset-s2 col s8"},l.a.createElement(E,{selectedProducts:this.selectedProducts}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"offset-s2 col s8"},l.a.createElement("b",{className:"left-align"},"Datos del pedido."))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"input-field offset-s2 col s4"},l.a.createElement("input",{value:this.state.name,type:"text",className:"validate",onChange:this.handleNameChanged}),l.a.createElement("label",{className:"active"},"Nombre")),l.a.createElement("div",{className:"input-field col s4"},l.a.createElement("input",{value:this.state.lastName,type:"text",className:"validate",onChange:this.handleLastNameChanged}),l.a.createElement("label",{className:"active"},"Apellido"))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"input-field offset-s2 col s8"},l.a.createElement("input",{value:this.state.phoneNumber,type:"text",className:"validate",onChange:this.handlePhoneNumberChanged}),l.a.createElement("label",{className:"active"},"Tel\xe9fono"))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col s12 right-align"},l.a.createElement("button",{className:"btn waves-effect waves-light"+e,onClick:this.sendProductsOrder},"Confirmar el pedido"))))}}]),t}(l.a.Component);var y=function(){return l.a.createElement(r.a,null,l.a.createElement("div",null,l.a.createElement("nav",null,l.a.createElement("div",{className:"nav-wrapper"},l.a.createElement("a",{href:"/",className:"brand-logo center"},"Pedidos"))),l.a.createElement("div",{id:"main-container",className:"container"},l.a.createElement(i.b,{path:"/",exact:!0,component:N}),l.a.createElement(i.b,{path:"/checkout/",component:C}))))};s.a.render(l.a.createElement(y,null),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.f63e279b.chunk.js.map